let canvas,ctx,tooltip,tooltipLink,SCALE=60,TRANSLATE=300;function addLabelsForPrint(){DATA.forEach(function(e){const t=document.createElement("span");t.classList.add("graph-label"),t.innerHTML=e.ideology;var o=(e.dim[0]+TRANSLATE/SCALE)*SCALE+e.dim[2]/2*SCALE,e=(-e.dim[1]+TRANSLATE/SCALE)*SCALE-e.dim[3]*SCALE;t.style.left=o+"px",t.style.top=e+"px",canvas.parentElement.appendChild(t)})}function hydrateResults(){initModalAlignment(),sessionStorage.getItem("_mode")||$("#take-quiz-modal").modal("show");var e=isMobileDevice();canvas=document.getElementById("resultsGraph"),tooltip=document.createElement("span"),tooltipLink=document.createElement("a"),tooltip.appendChild(tooltipLink),tooltip.classList.add("ctooltip"),canvas.parentElement.appendChild(tooltip),e?(SCALE=30,TRANSLATE=150,canvas.width=300,canvas.height=300,canvas.addEventListener("click",doubleTap,!1)):(canvas.addEventListener("mousemove",onMouseMove,!1),canvas.addEventListener("click",onClick,!1),canvas.parentElement.addEventListener("mouseenter",onMouseEnter,!1),canvas.parentElement.addEventListener("mouseleave",onMouseLeave,!1)),updateValues(),drawGraph(),console.log(sessionStorage.getItem("previousFinalX")),console.log(sessionStorage.getItem("previousFinalY"))}function setValue(e){document.getElementById(e).innerHTML=sessionStorage.getItem(e)}function getGraphObject(e,t,o){return{dim:e,color:t,ideology:o}}let _latestTap,DATA=[getGraphObject([-2,-2,4,4],"#7F35B2","Centrist"),getGraphObject([2,-2,2,4],"#BF0A30","Conservative"),getGraphObject([-4,-2,2,4],"#3C3B6E","Liberal"),getGraphObject([1,-4,3,2],"#FCD300","Libertarian"),getGraphObject([-4,-4,5,2],"#00B140","Social Libertarian"),getGraphObject([3,2,1,2],"#808000","Neoconservative"),getGraphObject([-4,2,7,2],"#964B00","Populist"),getGraphObject([4,3,1,1],"#CFC856","Paleolibertarian"),getGraphObject([4,-3,1,6],"#3ABEFF","Neoliberal"),getGraphObject([4,-4,1,1],"#006767","Minarchist"),getGraphObject([2.5,-5,2.5,1],"#E0A526","Anarcho-Capitalist"),getGraphObject([-2.5,-5,5,1],"#F4F9FF","Anarchist"),getGraphObject([-5,-5,2.5,1],"#EFD19F","Utopian Socialist"),getGraphObject([-5,-4,1,1],"#00B4B4","Libertarian Socialist"),getGraphObject([-5,-3,1,6],"#F395C7","Democratic Socialist"),getGraphObject([-5,3,1,1],"#F66775","State Socialist"),getGraphObject([-5,4,3.5,1],"#F93822","Communist"),getGraphObject([-1.5,4,4,1],"#6C7A86","Fascist"),getGraphObject([2.5,4,2.5,1],"#9EA16E","Paleoconservative")];function updateValues(){setValue(IDEOLOGY),document.getElementById(IDEOLOGY).href=linkForIdeology(sessionStorage.getItem(IDEOLOGY)),setValue(MILITARY),setValue(GREEN),setValue(DEFICIT)}function drawPointer(e,o,n){var a=["#000",e.color];for(let e=.3,t=0;0<e;e-=.1,t=(t+1)%a.length)ctx.fillStyle=a[t],ctx.beginPath(),ctx.arc(o,n,e,0,2*Math.PI),ctx.closePath(),ctx.fill()}function drawGraph(){(ctx=canvas.getContext("2d")).translate(TRANSLATE,TRANSLATE),ctx.scale(SCALE,-SCALE),DATA.forEach(function(e){ctx.beginPath(),ctx.rect.apply(ctx,e.dim),ctx.fillStyle=e.color,ctx.fill()});var e=Number(sessionStorage.getItem("previousFinalX")),t=Number(sessionStorage.getItem("previousFinalY"));drawPointer(findGraphObject(null,e,t),e,t)}function onMouseEnter(e){tooltip.style.display="block"}function onMouseLeave(e){tooltip.style.display="none"}function onMouseMove(e){(e=findGraphObject(e))&&showTooltip(e)}function showTooltip(e){tooltip.style.display="block";var t=Math.min(e.x,.67*canvas.width);tooltip.style.left=t+"px",tooltip.style.top=e.y+"px",tooltipLink.href=linkForIdeology(e.ideology),tooltipLink.innerHTML=e.ideology}function findGraphObject(e,t,o){let n,a;e&&(e.layerX||0==e.layerX)&&(n=e.layerX,a=e.layerY),0===t||t||0===o||o||(t=n/SCALE-TRANSLATE/SCALE,o=-(a/SCALE-TRANSLATE/SCALE));for(let e=0;e<DATA.length;e++){var i=DATA[e],l=i.dim[0],r=i.dim[1],c=i.dim[2],s=i.dim[3];if(l<=t&&t<=l+c&&r<=o&&o<=r+s)return Object.assign({x:n,y:a},i)}return!1}function onClick(e){(e=findGraphObject(e))&&goToLink(e.ideology)}function doubleTap(e){(new Date).getTime(),(e=findGraphObject(e))&&(showTooltip(e),_latestTap=(new Date).getTime())}function goToLink(e){window.location=linkForIdeology(e)}const CENTRIST="centrist";function linkForIdeology(e){const t=e.toLowerCase().replace(/ /g,"-");let o=t;return t.includes(CENTRIST)&&(o=CENTRIST),"ideology/"+o+".html"}function initModalAlignment(){function e(){var e=$(this).find(".modal-dialog");e.css("margin-top",Math.max(0,($(window).height()-e.height())/2))}$(".modal").on("shown.bs.modal",e),$(window).on("resize",function(){$(".modal:visible").each(e)}),$("#take-quiz-modal").on("hide.bs.modal",function(e){return!1})}